import{_ as z}from"./_plugin-vue_export-helper.c27b6911.js";import{k as r,l as m,t as F,d as L,aQ as S,ax as Y,r as p,K as I,F as a,m as x,af as C,ad as O,ae as N,T as A,W as D,D as h,q as V,av as $}from"./entry.01da0e6f.js";import q from"./articleItem.9834264a.js";import E from"./momentItem.17eed3fb.js";import K from"./albumItem.c17b2e2f.js";import"./topicTag.38311d61.js";import"./Vimg.51784125.js";/* empty css                */const Q={__name:"LoadMore",props:{loading:{type:Boolean,default:!1},hasMore:{type:Boolean,default:!1}},emits:["loadMore"],setup(u,{emit:g}){const i=u;function _(){!i.loading&&i.hasMore&&g("loadMore")}return(c,o)=>(r(),m("div",{class:"load-more",onClick:_},F(u.loading?"加载中":u.hasMore?"加载更多":"没有更多了"),1))}},R=z(Q,[["__scopeId","data-v-9e326d55"]]),W={key:0,class:"cover"},G=["src"],H={class:"home"},J=L({__name:"index",setup(u){var v;let i=S().globalSetting.website;const _=Y();let c=p((v=_.hash)==null?void 0:v.replace("#","")),o=p([]);const l=p({loading:!1,hasMore:!1,page:1,size:10});I(()=>_.hash,s=>{c.value=s==null?void 0:s.replace("#",""),f()},{immediate:!0});function B(){console.log("loadMore"),f(l.value.page+1)}function f(s=1){s==1&&(o.value=[]),l.value.loading=!0,$.get("/api/article",{type:c.value||"moment",page:s,size:l.value.size}).then(({data:d})=>{let t=d.list;c.value=="photo"&&(t=t.filter(e=>e.imgs.length>0)),t=t==null?void 0:t.map((e,n)=>(e.createTimeObj=new Date(Number(e.createTime)),e)),o.value=[...o.value,...t],l.value={...l.value,page:s,hasMore:d.page*d.size<d.total}}).finally(()=>{l.value.loading=!1})}return(s,d)=>{const t=R;return r(),m(O,null,[a(i).cover?(r(),m("div",W,[x("img",{src:a(i).cover},null,8,G)])):C("",!0),x("div",H,[(r(!0),m(O,null,N(a(o),(e,n)=>{var y,M,b,k,T,w,j;return r(),m("div",{class:A(["item",a(c)]),key:e._id.toString(),style:D(`animation-delay:${n%10*100}ms`)},[a(c)=="photo"?(r(),h(K,{key:0,data:e,showYear:n==0||((y=e.createTimeObj)==null?void 0:y.getFullYear())!=((b=(M=a(o)[n-1])==null?void 0:M.createTimeObj)==null?void 0:b.getFullYear()),showMonth:n==0||((k=e.createTimeObj)==null?void 0:k.getFullYear())!=((T=a(o)[n-1].createTimeObj)==null?void 0:T.getFullYear())||((w=e.createTimeObj)==null?void 0:w.getMonth())!=((j=a(o)[n-1].createTimeObj)==null?void 0:j.getMonth())},null,8,["data","showYear","showMonth"])):e.type=="moment"?(r(),h(E,{key:1,data:e},null,8,["data"])):(r(),h(q,{key:2,data:e},null,8,["data"]))],6)}),128)),V(t,{loading:a(l).loading,"has-more":a(l).hasMore,onLoadMore:B},null,8,["loading","has-more"])])],64)}}});const le=z(J,[["__scopeId","data-v-53adb2e3"]]);export{le as default};
