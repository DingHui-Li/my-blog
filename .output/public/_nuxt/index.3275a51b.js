import{_ as I}from"./_plugin-vue_export-helper.c27b6911.js";import{k as l,l as _,t as L,d as Y,z as C,A as F,c as B,az as A,r as f,B as N,C as a,m as c,D as $,ah as O,ai as D,W as V,Z as R,I as v,q,$ as E}from"./entry.3d29806f.js";import W from"./articleItem.e9b36112.js";import Z from"./momentItem.ad522ea6.js";import G from"./albumItem.87b6774d.js";import"./topicTag.dc1f10b1.js";import"./Vimg.0c6e311a.js";/* empty css                */const H={__name:"LoadMore",props:{loading:{type:Boolean,default:!1},hasMore:{type:Boolean,default:!1}},emits:["loadMore"],setup(u,{emit:p}){const d=u;function h(){!d.loading&&d.hasMore&&p("loadMore")}return(g,i)=>(l(),_("div",{class:"load-more",onClick:h},L(u.loading?"加载中":u.hasMore?"加载更多":"没有更多了"),1))}},J=I(H,[["__scopeId","data-v-9e326d55"]]),K={key:0,class:"cover"},P={class:"img-box"},Q=["src"],U={class:"profile"},X={class:"name"},ee={class:"avatar"},ae=["src"],oe={class:"home"},te=Y({__name:"index",setup(u){var M;const{globalSetting:p}=C(F()),d=B(()=>p.value.website||{}),h=B(()=>p.value.profile||{}),g=A();let i=f((M=g.hash)==null?void 0:M.replace("#","")),n=f([]);const t=f({loading:!1,hasMore:!1,page:1,size:10});N(()=>g.hash,s=>{i.value=s==null?void 0:s.replace("#",""),y()},{immediate:!0});function S(){console.log("loadMore"),y(t.value.page+1)}function y(s=1){s==1&&(n.value=[]),t.value.loading=!0,E.get("/api/article",{type:i.value||"moment",page:s,size:t.value.size}).then(({data:m})=>{let o=m.list;i.value=="photo"&&(o=o.filter(e=>e.imgs.length>0)),o=o==null?void 0:o.map((e,r)=>(e.createTimeObj=new Date(Number(e.createTime)),e)),n.value=[...n.value,...o],t.value={...t.value,page:s,hasMore:m.page*m.size<m.total}}).finally(()=>{t.value.loading=!1})}return(s,m)=>{const o=J;return l(),_(O,null,[a(d).cover?(l(),_("div",K,[c("div",P,[c("img",{src:a(d).cover},null,8,Q)]),c("div",U,[c("div",X,L(a(h).name),1),c("div",ee,[c("img",{src:a(h).avatar,alt:""},null,8,ae)])])])):$("",!0),c("div",oe,[(l(!0),_(O,null,D(a(n),(e,r)=>{var b,k,T,w,z,j,x;return l(),_("div",{class:V(["item",a(i)]),key:e._id.toString(),style:R(`animation-delay:${r%10*100}ms`)},[a(i)=="photo"?(l(),v(G,{key:0,data:e,showYear:r==0||((b=e.createTimeObj)==null?void 0:b.getFullYear())!=((T=(k=a(n)[r-1])==null?void 0:k.createTimeObj)==null?void 0:T.getFullYear()),showMonth:r==0||((w=e.createTimeObj)==null?void 0:w.getFullYear())!=((z=a(n)[r-1].createTimeObj)==null?void 0:z.getFullYear())||((j=e.createTimeObj)==null?void 0:j.getMonth())!=((x=a(n)[r-1].createTimeObj)==null?void 0:x.getMonth())},null,8,["data","showYear","showMonth"])):e.type=="moment"?(l(),v(Z,{key:1,data:e},null,8,["data"])):(l(),v(W,{key:2,data:e},null,8,["data"]))],6)}),128)),q(o,{loading:a(t).loading,"has-more":a(t).hasMore,onLoadMore:S},null,8,["loading","has-more"])])],64)}}});const _e=I(te,[["__scopeId","data-v-ba9d3170"]]);export{_e as default};
