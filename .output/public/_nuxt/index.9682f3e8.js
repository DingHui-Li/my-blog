import{_ as O}from"./_plugin-vue_export-helper.c27b6911.js";import{k as l,l as m,t as S,d as L,z as F,ay as I,r as f,M as A,A as a,m as c,B as C,ag as B,ah as N,V,Y as $,G as v,q as D,$ as q}from"./entry.68178e43.js";import E from"./articleItem.0270efbd.js";import G from"./momentItem.9c2ce357.js";import R from"./albumItem.41467dfc.js";import"./topicTag.72e1fd53.js";import"./Vimg.831539e5.js";/* empty css                */const H={__name:"LoadMore",props:{loading:{type:Boolean,default:!1},hasMore:{type:Boolean,default:!1}},emits:["loadMore"],setup(u,{emit:p}){const d=u;function h(){!d.loading&&d.hasMore&&p("loadMore")}return(g,i)=>(l(),m("div",{class:"load-more",onClick:h},S(u.loading?"加载中":u.hasMore?"加载更多":"没有更多了"),1))}},J=O(H,[["__scopeId","data-v-9e326d55"]]),K={key:0,class:"cover"},P={class:"img-box"},Q=["src"],U={class:"profile"},W={class:"name"},X={class:"avatar"},Z=["src"],ee={class:"home"},ae=L({__name:"index",setup(u){var M;const p=F();let d=p.globalSetting.website,h=p.globalSetting.profile;const g=I();let i=f((M=g.hash)==null?void 0:M.replace("#","")),n=f([]);const o=f({loading:!1,hasMore:!1,page:1,size:10});A(()=>g.hash,s=>{i.value=s==null?void 0:s.replace("#",""),y()},{immediate:!0});function Y(){console.log("loadMore"),y(o.value.page+1)}function y(s=1){s==1&&(n.value=[]),o.value.loading=!0,q.get("/api/article",{type:i.value||"moment",page:s,size:o.value.size}).then(({data:_})=>{let t=_.list;i.value=="photo"&&(t=t.filter(e=>e.imgs.length>0)),t=t==null?void 0:t.map((e,r)=>(e.createTimeObj=new Date(Number(e.createTime)),e)),n.value=[...n.value,...t],o.value={...o.value,page:s,hasMore:_.page*_.size<_.total}}).finally(()=>{o.value.loading=!1})}return(s,_)=>{const t=J;return l(),m(B,null,[a(d).cover?(l(),m("div",K,[c("div",P,[c("img",{src:a(d).cover},null,8,Q)]),c("div",U,[c("div",W,S(a(h).name),1),c("div",X,[c("img",{src:a(h).avatar,alt:""},null,8,Z)])])])):C("",!0),c("div",ee,[(l(!0),m(B,null,N(a(n),(e,r)=>{var b,k,w,T,j,x,z;return l(),m("div",{class:V(["item",a(i)]),key:e._id.toString(),style:$(`animation-delay:${r%10*100}ms`)},[a(i)=="photo"?(l(),v(R,{key:0,data:e,showYear:r==0||((b=e.createTimeObj)==null?void 0:b.getFullYear())!=((w=(k=a(n)[r-1])==null?void 0:k.createTimeObj)==null?void 0:w.getFullYear()),showMonth:r==0||((T=e.createTimeObj)==null?void 0:T.getFullYear())!=((j=a(n)[r-1].createTimeObj)==null?void 0:j.getFullYear())||((x=e.createTimeObj)==null?void 0:x.getMonth())!=((z=a(n)[r-1].createTimeObj)==null?void 0:z.getMonth())},null,8,["data","showYear","showMonth"])):e.type=="moment"?(l(),v(G,{key:1,data:e},null,8,["data"])):(l(),v(E,{key:2,data:e},null,8,["data"]))],6)}),128)),D(t,{loading:a(o).loading,"has-more":a(o).hasMore,onLoadMore:Y},null,8,["loading","has-more"])])],64)}}});const de=O(ae,[["__scopeId","data-v-97c0ddc5"]]);export{de as default};
